<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mindf*ck</title>
  
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- FontAwesome -->
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

  <style>
    body {
      font-family: 'Roboto', sans-serif;
    }

    .mindfuck-container {
      max-width: 90%;
      width: 400px;
    }

    .loading-spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #7c3aed;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .fade-in {
      animation: fadeIn 1s ease-in-out;
    }

    @keyframes fadeIn {
      0% {
        opacity: 0;
      }
      100% {
        opacity: 1;
      }
    }

    /* Odpočet animace */
    .countdown {
      font-size: 1.2rem;
      font-weight: bold;
      color: #7c3aed;
    }

    .countdown-text {
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }

    .countdown-text.visible {
      opacity: 1;
    }

  </style>
</head>
<body class="bg-gradient-to-r from-purple-500 to-purple-900 min-h-screen flex flex-col items-center justify-center">

  <header class="text-center text-white text-3xl font-bold py-4 w-full">
    Mindf*ck <i class="fas fa-brain"></i>
  </header>

  <div id="mindfuck-content" class="mindfuck-container bg-white text-purple-900 p-6 rounded-xl shadow-lg flex justify-center items-center h-64">
    <div id="loading-spinner" class="loading-spinner"></div>
    <p id="mindfuck-text" class="text-center text-lg font-semibold text-gray-700 hidden">Načítám...</p>
  </div>

  <div id="countdown-container" class="mt-4 text-center">
    <p id="countdown-text" class="countdown countdown-text">Nastavení odpočtu...</p>
  </div>

  <script>
    // Načteme moudra z JSON souboru
    async function fetchMindfucks() {
      try {
        const response = await fetch('https://api.hostio.xyz/fun/mindfuck/v1.json');
        const data = await response.json();
        return data;
      } catch (error) {
        console.error('Chyba při načítání moudra:', error);
        return [];
      }
    }

    // Načteme poslední reset z localStorage
    const lastReset = localStorage.getItem('lastReset');
    const currentTime = Date.now();
    const resetInterval = 2400; // 24 hodin v milisekundách

    let mindfuckText = '';
    
    // Funkce pro zobrazení moudra
    async function displayMindfuck() {
      const mindfucks = await fetchMindfucks();
      if (mindfucks.length === 0) {
        document.getElementById('mindfuck-text').textContent = "Chyba při načítání moudra!";
        document.getElementById('loading-spinner').classList.add('hidden');
        document.getElementById('mindfuck-text').classList.remove('hidden');
        return;
      }

      // Zvolíme náhodné moudro
      if (!lastReset || currentTime - lastReset >= resetInterval) {
        localStorage.setItem('lastReset', currentTime);
        mindfuckText = mindfucks[Math.floor(Math.random() * mindfucks.length)];
      } else {
        mindfuckText = localStorage.getItem('mindfuckText');
      }

      // Uložení moudra do localStorage
      localStorage.setItem('mindfuckText', mindfuckText);

      // Načteme text do HTML
      document.getElementById('mindfuck-text').textContent = mindfuckText;
      document.getElementById('loading-spinner').classList.add('hidden');
      document.getElementById('mindfuck-text').classList.remove('hidden');
    }

    // Funkce pro odpočet (24 hodin)
    function startCountdown() {
      const endTime = parseInt(localStorage.getItem('lastReset')) + resetInterval;
      const countdownElement = document.getElementById('countdown-text');
      
      function updateCountdown() {
        const currentTime = Date.now();
        const timeRemaining = endTime - currentTime;

        if (timeRemaining <= 0) {
          countdownElement.textContent = 'Nové moudro brzy!';
          countdownElement.classList.remove('visible');
        } else {
          const hours = Math.floor(timeRemaining / (1000 * 60 * 60));
          const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
          const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);
          
          countdownElement.textContent = `${hours}h ${minutes}m ${seconds}s`;
          countdownElement.classList.add('visible');
        }
      }

      setInterval(updateCountdown, 1000);
      updateCountdown();  // Volání pro okamžité zobrazení
    }

    // Zobrazíme moudro a spustíme odpočet
    displayMindfuck();
    startCountdown();
  </script>
</body>
</html>
